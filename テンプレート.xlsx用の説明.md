# Excelテンプレートの作成方法

## 簡単セットアップガイド

### ステップ1: 新しいExcelファイルを作成

1. Excelを開く
2. 「新しいブック」を作成
3. `kurumawari_template.xlsx` という名前で保存

### ステップ2: シート1「メンバー情報」の作成

#### シート名を変更
- デフォルトの「Sheet1」を右クリック → 「名前の変更」→ `メンバー情報` に変更

#### ヘッダー行（1行目）を入力:

| A1 | B1 | C1 | D1 | E1 | F1 | G1 | H1 |
|----|----|----|----|----|----|----|-----|
| 名前 | 行き日 | 行き時 | 行き場所 | 帰り日 | 帰り時 | 帰り場所 | 運転可 |

#### サンプルデータ（2行目以降）:

```
Aさん   11/1    夜    福井    11/3    夕方    金沢駅    ○
Bさん   11/1    夜    福井    11/3    夕方    金沢駅    ×
Cさん   11/1    夜    福井    11/3    夕方    金沢駅    ×
```

### ステップ3: シート2「車割結果」の作成

1. シートを追加（左下の「+」ボタン）
2. シート名を `車割結果` に変更
3. **このシートは空のままでOK**（マクロが自動で埋めます）

### ステップ4: マクロの追加

#### VBAエディタを開く
- `Alt + F11` を押す

#### モジュールを追加
1. VBAエディタの左側に表示されているプロジェクトエクスプローラーで、あなたのブック名を確認
2. メニューバーから「挿入 (Insert)」→「モジュール (Module)」をクリック
   - ※「標準モジュール」ではなく「モジュール」と表示されています
3. 新しい「Module1」が左側のプロジェクトエクスプローラーに追加されます
4. 右側に白い編集画面が表示されます

#### コードを貼り付け
1. `KurumawariMacro.bas` ファイルの内容を**全て**コピー（Ctrl+A → Ctrl+C）
2. VBAエディタの右側の編集画面に貼り付け（Ctrl+V）
3. VBAエディタを閉じる（`Alt + Q` または右上の×ボタン）

#### ファイルを保存
- 「名前を付けて保存」→ ファイルの種類を `Excelマクロ有効ブック (*.xlsm)` に変更
- `kurumawari_template.xlsm` として保存

### ステップ5: マクロの実行

#### 開発タブを表示（初回のみ）
1. 「ファイル」→「オプション」
2. 「リボンのユーザー設定」
3. 右側の一覧で「開発」にチェックを入れる
4. OK

#### マクロを実行
1. 「開発」タブをクリック
2. 「マクロ」ボタンをクリック
3. `GenerateKurumawari` を選択
4. 「実行」ボタン

## データ入力のルール

### 日付の形式
- ✅ 正: `11/1`, `11/2`, `11/3`
- ❌ 誤: `2025/11/1`, `11月1日`, `11-1`

### 時刻の形式
- 例: `夜`, `朝`, `昼前`, `夕方`, `午後`
- 自由に入力できますが、同じ時刻は同じ表記にしてください

### 場所
- 例: `福井`, `金沢駅`
- 同じ場所は同じ表記にしてください

### 運転可否
- ✅ 運転できる: `○` （まるマーク）
- ❌ 運転できない: `×` （バツマーク）
- ⚠️ 注意: 全角文字を使用してください

## 便利な使い方

### ショートカットキーの設定

マクロ実行を簡単にするため、ショートカットを設定できます:

1. 「開発」タブ → 「マクロ」
2. `GenerateKurumawari` を選択
3. 「オプション」ボタン
4. ショートカットキーを入力（例: `K` → `Ctrl + Shift + K` になる）
5. OK

これで `Ctrl + Shift + K` を押すだけでマクロが実行されます！

### ボタンを作成する

もっと簡単にするため、ボタンを作成できます:

1. 「開発」タブ → 「挿入」
2. 「フォームコントロール」から「ボタン」を選択
3. シート上でドラッグしてボタンを配置
4. マクロの選択画面で `GenerateKurumawari` を選択
5. ボタンの上で右クリック → 「テキストの編集」→ `車割を作成` などに変更

## トラブルシューティング

### マクロが見つからない
- ファイルが `.xlsm` 形式で保存されているか確認
- VBAエディタで `KurumawariMacro` モジュールが存在するか確認

### 「マクロが無効」と表示される
1. ファイルを開いたときに表示される黄色いバー
2. 「コンテンツの有効化」ボタンをクリック

### エラー「シートが見つかりません」
- シート名が正確に `メンバー情報` と `車割結果` になっているか確認
- 全角スペースや余分なスペースがないか確認

### 結果がおかしい
- ヘッダー行が1行目にあるか確認
- データが2行目から始まっているか確認
- 列の順序が正しいか確認（A列から順に: 名前、行き日、行き時...）

## 配布方法

このテンプレートを他の人に配布する場合:

1. `kurumawari_template.xlsm` ファイルをコピー
2. 一緒に `README.md` も渡す
3. 最初に「コンテンツの有効化」をクリックするよう伝える

## サンプルデータ

テスト用のサンプルデータ:

```
Aさん   11/1  夜    福井   11/3  夕方  金沢駅  ○
Bさん   11/1  夜    福井   11/3  夕方  金沢駅  ×
Cさん   11/1  夜    福井   11/3  夕方  金沢駅  ×
Dさん   11/1  夜    福井   11/3  夕方  金沢駅  ○
Eさん   11/2  朝    福井   11/3  夕方  金沢駅  ○
Fさん   11/2  昼前  福井   11/3  夕方  金沢駅  ○
Gさん   11/2  夜    福井   11/3  夕方  金沢駅  ○
Hさん   11/2  夜    福井   11/3  夕方  金沢駅  ×
Iさん   11/2  夜    福井   11/3  夕方  金沢駅  ×
Jさん   11/2  夜    福井   11/3  夕方  金沢駅  ×
Kさん   11/2  夜    福井   11/3  夕方  金沢駅  ○
Lさん   11/2  夜    福井   11/3  夕方  金沢駅  ×
Mさん   11/2  夜    福井   11/3  夕方  金沢駅  ×
Nさん   11/2  夜    福井   11/3  夕方  金沢駅  ×
Oさん   11/3  夕方  金沢駅 11/3  夕方  金沢駅  ○
Pさん   11/3  夕方  金沢駅 11/3  夕方  金沢駅  ×
Qさん   11/3  夕方  金沢駅 11/3  夕方  金沢駅  ×
Rさん   11/3  夕方  金沢駅 11/3  夕方  金沢駅  ×
Sさん   11/3  夕方  金沢駅 11/3  夕方  金沢駅  ×
Tさん   11/3  夕方  金沢駅 11/3  夕方  金沢駅  ×
Uさん   11/3  夕方  金沢駅 11/3  夕方  金沢駅  ×
Vさん   11/3  夕方  金沢駅 11/3  夕方  金沢駅  ×
```
